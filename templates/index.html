{% extends "base.html" %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section">
    <div class="container">
        <div class="row align-items-center min-vh-100">
            <div class="col-lg-6">
                <div class="hero-content">
                    <h1 class="display-4 fw-bold text-white mb-4">
                        ğŸ¯ AIê°€ ì˜ˆì¸¡í•˜ëŠ”<br>
                        <span class="text-warning">ë¡œë˜ ë‹¹ì²¨ë²ˆí˜¸</span>
                    </h1>
                    <p class="lead text-white-50 mb-4">
                        ì‹¤ì œ 1,188íšŒì°¨ ë‹¹ì²¨ ë°ì´í„°ë¥¼ ë¶„ì„í•˜ëŠ” 5ê°€ì§€ ë…ìì  AI ëª¨ë¸ì´ 
                        ìµœì ì˜ ë¡œë˜ ì˜ˆìƒë²ˆí˜¸ë¥¼ ì¶”ì²œí•´ë“œë¦½ë‹ˆë‹¤.
                    </p>
                    
                    <!-- ì‹¤ì‹œê°„ ë¶„ì„ ìƒíƒœ í‘œì‹œ -->
                    <div class="analysis-status mb-4" id="analysisStatus">
                        <div class="d-flex align-items-center text-success">
                            <div class="spinner-border spinner-border-sm me-2" role="status" id="analysisSpinner">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                            <small id="analysisStatusText">ë°ì´í„° ë¶„ì„ ì¤‘...</small>
                        </div>
                    </div>
                    
                    <div class="hero-stats row text-center mb-4">
                        <div class="col-4">
                            <div class="stat-item">
                                <h3 class="text-warning">5</h3>
                                <small class="text-white-50">AI ëª¨ë¸</small>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="stat-item">
                                <h3 class="text-warning" id="dataCountDisplay">1188</h3>
                                <small class="text-white-50">ë¶„ì„ íšŒì°¨</small>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="stat-item">
                                <h3 class="text-warning">FREE</h3>
                                <small class="text-white-50">ì™„ì „ ë¬´ë£Œ</small>
                            </div>
                        </div>
                    </div>
                    <a href="#prediction" class="btn btn-warning btn-lg px-4 py-3 rounded-pill">
                        <i class="fas fa-magic me-2"></i>ì§€ê¸ˆ ì˜ˆì¸¡ ì‹œì‘í•˜ê¸°
                    </a>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="hero-animation text-center">
                    <!-- ì‹¤ì‹œê°„ ì˜ˆì‹œë²ˆí˜¸ ì»¨í…Œì´ë„ˆ -->
                    <div class="example-numbers-container mb-3">
                        <div class="lotto-ball-container" id="heroExampleNumbers">
                            <!-- AIê°€ ì‹¤ì‹œê°„ìœ¼ë¡œ ìƒì„±í•˜ëŠ” ì˜ˆì‹œ ë²ˆí˜¸ë“¤ -->
                            <div class="lotto-ball lotto-ball-1 example-ball" data-number="1">1</div>
                            <div class="lotto-ball lotto-ball-2 example-ball" data-number="7">7</div>
                            <div class="lotto-ball lotto-ball-3 example-ball" data-number="13">13</div>
                            <div class="lotto-ball lotto-ball-4 example-ball" data-number="25">25</div>
                            <div class="lotto-ball lotto-ball-5 example-ball" data-number="31">31</div>
                            <div class="lotto-ball lotto-ball-6 example-ball" data-number="42">42</div>
                        </div>
                        
                        <!-- ì˜ˆì‹œë²ˆí˜¸ ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼ -->
                        <div class="text-center mt-2">
                            <button class="btn btn-sm btn-outline-light" id="refreshExampleBtn" title="ìƒˆë¡œìš´ ì˜ˆì‹œë²ˆí˜¸ ìƒì„±">
                                <i class="fas fa-sync-alt me-1"></i> ìƒˆë¡œìš´ ì˜ˆì‹œ
                            </button>
                        </div>
                    </div>
                    
                    <div class="example-description" id="exampleDescription">
                        AIê°€ ë¶„ì„í•œ ì˜ˆìƒë²ˆí˜¸ ì˜ˆì‹œ<br>
                        <small class="text-success">ğŸ“Š ë°ì´í„° ë¡œë”© ì¤‘...</small><br>
                        <small class="text-warning">âœ¨ 30ì´ˆë§ˆë‹¤ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸</small>
                    </div>
                    
                    <!-- ì˜ˆì‹œë²ˆí˜¸ ë¶„ì„ ì •ë³´ -->
                    <div class="example-info mt-3" id="exampleInfo">
                        <small class="text-light opacity-75">
                            ë¶„ì„ ì •ë³´ ë¡œë”© ì¤‘...
                        </small>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Features Section -->
<section id="features" class="py-5 bg-light">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="display-5 fw-bold">ğŸ¤– 5ê°€ì§€ AI ì˜ˆì¸¡ ëª¨ë¸</h2>
            <p class="lead text-muted">ì‹¤ì œ ë‹¹ì²¨ ë°ì´í„°ë¥¼ ê°ê¸° ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ ë¶„ì„í•˜ì—¬ ìµœì ì˜ ì˜ˆì¸¡ì„ ì œê³µí•©ë‹ˆë‹¤</p>
            
            <!-- ë°ì´í„° ë¶„ì„ ìƒíƒœ í‘œì‹œ -->
            <div class="analysis-indicators mt-4" id="featureAnalysisStatus">
                <div class="row justify-content-center">
                    <div class="col-md-8">
                        <div class="d-flex justify-content-around">
                            <div class="analysis-indicator" id="frequencyIndicator">
                                <i class="fas fa-chart-bar text-muted"></i>
                                <small class="d-block">ë¹ˆë„ë¶„ì„</small>
                            </div>
                            <div class="analysis-indicator" id="trendIndicator">
                                <i class="fas fa-trending-up text-muted"></i>
                                <small class="d-block">íŠ¸ë Œë“œë¶„ì„</small>
                            </div>
                            <div class="analysis-indicator" id="patternIndicator">
                                <i class="fas fa-project-diagram text-muted"></i>
                                <small class="d-block">íŒ¨í„´ë¶„ì„</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row g-4">
            <div class="col-md-6 col-lg-4">
                <div class="feature-card h-100">
                    <div class="feature-icon">
                        <i class="fas fa-chart-bar"></i>
                    </div>
                    <h5>ë¹ˆë„ë¶„ì„ ëª¨ë¸</h5>
                    <p class="text-muted">1,188íšŒì°¨ ë‹¹ì²¨ë²ˆí˜¸ ì¶œí˜„ ë¹ˆë„ë¥¼ ë¶„ì„í•˜ì—¬ ê°€ì¤‘ í™•ë¥ ë¡œ ì˜ˆì¸¡</p>
                    <div class="feature-status" id="frequencyStatus">
                        <small class="text-muted">ë¶„ì„ ëŒ€ê¸° ì¤‘...</small>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6 col-lg-4">
                <div class="feature-card h-100">
                    <div class="feature-icon">
                        <i class="fas fa-trending-up"></i>
                    </div>
                    <h5>íŠ¸ë Œë“œë¶„ì„ ëª¨ë¸</h5>
                    <p class="text-muted">ìµœê·¼ 50íšŒì°¨ ë‹¹ì²¨ íŒ¨í„´ê³¼ íŠ¸ë Œë“œë¥¼ ë¶„ì„í•˜ì—¬ ì‹œê¸°ë³„ ë³€í™” ë°˜ì˜</p>
                    <div class="feature-status" id="trendStatus">
                        <small class="text-muted">ë¶„ì„ ëŒ€ê¸° ì¤‘...</small>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6 col-lg-4">
                <div class="feature-card h-100">
                    <div class="feature-icon">
                        <i class="fas fa-project-diagram"></i>
                    </div>
                    <h5>íŒ¨í„´ë¶„ì„ ëª¨ë¸</h5>
                    <p class="text-muted">ë²ˆí˜¸ ì¡°í•© íŒ¨í„´ê³¼ ìˆ˜í•™ì  ê´€ê³„ë¥¼ ë¶„ì„í•˜ì—¬ ë³µí•© ì˜ˆì¸¡</p>
                    <div class="feature-status" id="patternStatus">
                        <small class="text-muted">ë¶„ì„ ëŒ€ê¸° ì¤‘...</small>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6 col-lg-4">
                <div class="feature-card h-100">
                    <div class="feature-icon">
                        <i class="fas fa-calculator"></i>
                    </div>
                    <h5>í†µê³„ë¶„ì„ ëª¨ë¸</h5>
                    <p class="text-muted">ê³ ê¸‰ í†µê³„ ê¸°ë²•ê³¼ í™•ë¥  ì´ë¡ ì„ ì ìš©í•œ ìˆ˜í•™ì  ì˜ˆì¸¡</p>
                    <div class="feature-status">
                        <small class="text-success">âœ… ì¤€ë¹„ ì™„ë£Œ</small>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6 col-lg-4">
                <div class="feature-card h-100">
                    <div class="feature-icon">
                        <i class="fas fa-brain"></i>
                    </div>
                    <h5>ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸</h5>
                    <p class="text-muted">ë”¥ëŸ¬ë‹ ì‹ ê²½ë§ê³¼ AI ì•Œê³ ë¦¬ì¦˜ ê¸°ë°˜ ê³ ë„í™”ëœ ì˜ˆì¸¡</p>
                    <div class="feature-status">
                        <small class="text-success">âœ… ì¤€ë¹„ ì™„ë£Œ</small>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6 col-lg-4">
                <div class="feature-card h-100">
                    <div class="feature-icon">
                        <i class="fas fa-crown"></i>
                    </div>
                    <h5>ì¢…í•©ì¶”ì²œ ì‹œìŠ¤í…œ</h5>
                    <p class="text-muted">5ê°€ì§€ ëª¨ë¸ ê²°ê³¼ë¥¼ ì¢…í•©í•˜ì—¬ ìµœê³ ì˜ ì¶”ì²œë²ˆí˜¸ ì„ ë³„</p>
                    <div class="feature-status">
                        <small class="text-warning">â³ ë¶„ì„ ì™„ë£Œ í›„ í™œì„±í™”</small>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Prediction Section -->
<section id="prediction" class="py-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="prediction-wrapper">
                    <div class="text-center mb-5">
                        <h2 class="display-5 fw-bold">ğŸ² AI ì˜ˆìƒë²ˆí˜¸ ìƒì„±</h2>
                        <p class="lead text-muted">ì›í•˜ëŠ” ë²ˆí˜¸ê°€ ìˆë‹¤ë©´ ì…ë ¥í•˜ì„¸ìš”. AIê°€ ë‚˜ë¨¸ì§€ë¥¼ ì¶”ì²œí•´ë“œë¦½ë‹ˆë‹¤!</p>
                        
                        <!-- ë°ì´í„° ì†ŒìŠ¤ ì •ë³´ -->
                        <div class="data-source-display mt-3" id="predictionDataSource">
                            <div class="alert alert-info d-inline-flex align-items-center">
                                <i class="fas fa-database me-2"></i>
                                <span id="dataSourceText">ë°ì´í„° ë¡œë”© ì¤‘...</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- User Input Section -->
                    <div class="card shadow-lg border-0 mb-4">
                        <div class="card-header bg-gradient-primary text-white">
                            <h5 class="mb-0">
                                <i class="fas fa-heart me-2"></i>ì„ í˜¸í•˜ëŠ” ë²ˆí˜¸ ì…ë ¥ (ì„ íƒì‚¬í•­)
                            </h5>
                        </div>
                        <div class="card-body">
                            <form id="predictionForm">
                                <div class="mb-4">
                                    <label class="form-label fw-bold">
                                        ìƒì¼, ê¸°ë…ì¼ ë“± ì›í•˜ëŠ” ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš” (1~45)
                                    </label>
                                    <div class="number-input-grid">
                                        <input type="number" class="form-control number-input" 
                                               placeholder="ë²ˆí˜¸1" min="1" max="45" id="num1">
                                        <input type="number" class="form-control number-input" 
                                               placeholder="ë²ˆí˜¸2" min="1" max="45" id="num2">
                                        <input type="number" class="form-control number-input" 
                                               placeholder="ë²ˆí˜¸3" min="1" max="45" id="num3">
                                        <input type="number" class="form-control number-input" 
                                               placeholder="ë²ˆí˜¸4" min="1" max="45" id="num4">
                                        <input type="number" class="form-control number-input" 
                                               placeholder="ë²ˆí˜¸5" min="1" max="45" id="num5">
                                        <input type="number" class="form-control number-input" 
                                               placeholder="ë²ˆí˜¸6" min="1" max="45" id="num6">
                                    </div>
                                    <small class="text-muted">
                                        ğŸ’¡ ë¹„ì›Œë‘ë©´ AIê°€ ëª¨ë“  ë²ˆí˜¸ë¥¼ ìë™ìœ¼ë¡œ ì„ íƒí•©ë‹ˆë‹¤
                                    </small>
                                </div>
                                
                                <div class="text-center">
                                    <button type="submit" class="btn btn-gradient-primary btn-lg px-5 py-3 rounded-pill" id="predictBtn">
                                        <i class="fas fa-magic me-2"></i>
                                        <span class="btn-text">AI ì˜ˆìƒë²ˆí˜¸ ìƒì„±í•˜ê¸°</span>
                                        <div class="spinner-border spinner-border-sm ms-2 d-none" role="status"></div>
                                    </button>
                                    
                                    <!-- ë¶„ì„ ìƒíƒœ ê²½ê³  -->
                                    <div class="mt-2" id="predictionWarning" style="display: none;">
                                        <small class="text-warning">
                                            <i class="fas fa-exclamation-triangle me-1"></i>
                                            ì¼ë¶€ ë¶„ì„ì´ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤. ê¸°ë³¸ ì˜ˆì¸¡ìœ¼ë¡œ ì§„í–‰ë©ë‹ˆë‹¤.
                                        </small>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                    
                    <!-- Loading Indicator -->
                    <div id="loadingSection" class="text-center py-5 d-none">
                        <div class="loading-animation">
                            <div class="spinner-grow text-primary" role="status"></div>
                            <div class="spinner-grow text-success" role="status"></div>
                            <div class="spinner-grow text-warning" role="status"></div>
                        </div>
                        <h4 class="mt-3">AI ëª¨ë¸ì´ ì‹¤ì œ ë°ì´í„°ë¥¼ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤...</h4>
                        <p class="text-muted">ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”. ìµœì ì˜ ë²ˆí˜¸ë¥¼ ì°¾ê³  ìˆì–´ìš”! ğŸ¤–</p>
                        
                        <!-- ë¡œë”© ì§„í–‰ í‘œì‹œ -->
                        <div class="progress mt-3" style="max-width: 400px; margin: 0 auto;">
                            <div class="progress-bar progress-bar-striped progress-bar-animated" 
                                 role="progressbar" style="width: 0%" id="loadingProgress"></div>
                        </div>
                    </div>
                    
                    <!-- Results Section -->
                    <div id="resultsSection" class="d-none">
                        <!-- Top Recommendations -->
                        <div class="card shadow-lg border-0 mb-4">
                            <div class="card-header bg-gradient-success text-white">
                                <h5 class="mb-0">
                                    <i class="fas fa-crown me-2"></i>AI ìµœê³  ì¶”ì²œ ë²ˆí˜¸ TOP 5
                                </h5>
                            </div>
                            <div class="card-body">
                                <div id="topRecommendations" class="row g-3">
                                    <!-- Dynamic content -->
                                </div>
                            </div>
                        </div>
                        
                        <!-- Model Results -->
                        <div class="card shadow-lg border-0">
                            <div class="card-header bg-gradient-info text-white">
                                <h5 class="mb-0">
                                    <i class="fas fa-robot me-2"></i>ëª¨ë¸ë³„ ìƒì„¸ ë¶„ì„ ê²°ê³¼
                                </h5>
                            </div>
                            <div class="card-body">
                                <div id="modelResults">
                                    <!-- Dynamic content -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Stats Section -->
<section id="stats" class="py-5 bg-light">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="display-5 fw-bold">ğŸ“Š ì‹¤ì‹œê°„ í†µê³„ ë¶„ì„</h2>
            <p class="lead text-muted">ì‹¤ì œ ë‹¹ì²¨ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ ì‹¤ì‹œê°„ ë¶„ì„ ê²°ê³¼</p>
            
            <!-- í†µê³„ ë°ì´í„° ì†ŒìŠ¤ í‘œì‹œ -->
            <div class="stats-source mt-3" id="statsSource">
                <small class="text-muted">ë°ì´í„° ë¡œë”© ì¤‘...</small>
            </div>
        </div>
        
        <div class="row g-4">
            <div class="col-lg-6">
                <div class="card shadow border-0 h-100">
                    <div class="card-header bg-danger text-white">
                        <h6 class="mb-0">
                            <i class="fas fa-fire me-2"></i>í•« ë„˜ë²„ (ìì£¼ ë‚˜ì˜¤ëŠ” ë²ˆí˜¸)
                        </h6>
                    </div>
                    <div class="card-body">
                        <div id="hotNumbers" class="number-display">
                            <!-- Loading placeholder -->
                            <div class="text-center py-3">
                                <div class="spinner-border text-danger" role="status">
                                    <span class="visually-hidden">Loading...</span>
                                </div>
                                <p class="mt-2 text-muted">í•«ë„˜ë²„ ë¶„ì„ ì¤‘...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-6">
                <div class="card shadow border-0 h-100">
                    <div class="card-header bg-primary text-white">
                        <h6 class="mb-0">
                            <i class="fas fa-snowflake me-2"></i>ì½œë“œ ë„˜ë²„ (ì˜ ì•ˆ ë‚˜ì˜¤ëŠ” ë²ˆí˜¸)
                        </h6>
                    </div>
                    <div class="card-body">
                        <div id="coldNumbers" class="number-display">
                            <!-- Loading placeholder -->
                            <div class="text-center py-3">
                                <div class="spinner-border text-primary" role="status">
                                    <span class="visually-hidden">Loading...</span>
                                </div>
                                <p class="mt-2 text-muted">ì½œë“œë„˜ë²„ ë¶„ì„ ì¤‘...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- í†µê³„ ìš”ì•½ ì •ë³´ -->
        <div class="row mt-4">
            <div class="col-12">
                <div class="card shadow border-0">
                    <div class="card-body">
                        <div class="row text-center">
                            <div class="col-md-3">
                                <h4 class="text-primary" id="totalDraws">-</h4>
                                <small class="text-muted">ì´ ë¶„ì„ íšŒì°¨</small>
                            </div>
                            <div class="col-md-3">
                                <h4 class="text-success" id="dataQuality">-</h4>
                                <small class="text-muted">ë°ì´í„° í’ˆì§ˆ</small>
                            </div>
                            <div class="col-md-3">
                                <h4 class="text-warning" id="analysisModels">5</h4>
                                <small class="text-muted">ë¶„ì„ ëª¨ë¸</small>
                            </div>
                            <div class="col-md-3">
                                <h4 class="text-info" id="lastUpdate">-</h4>
                                <small class="text-muted">ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- About Section -->
<section id="about" class="py-5">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-6">
                <h2 class="display-5 fw-bold mb-4">ğŸ¯ ì™œ LottoPro AIì¸ê°€ìš”?</h2>
                <div class="about-features">
                    <div class="about-feature-item">
                        <i class="fas fa-check-circle text-success me-3"></i>
                        <div>
                            <h6>ì‹¤ì œ ë°ì´í„° ê¸°ë°˜ ë¶„ì„</h6>
                            <p class="text-muted mb-0">1,188íšŒì°¨ ì‹¤ì œ ë‹¹ì²¨ë²ˆí˜¸ë¥¼ ë¶„ì„í•˜ì—¬ í˜„ì‹¤ì  ì˜ˆì¸¡ ì œê³µ</p>
                        </div>
                    </div>
                    <div class="about-feature-item">
                        <i class="fas fa-check-circle text-success me-3"></i>
                        <div>
                            <h6>5ê°€ì§€ ë…ìì  AI ëª¨ë¸</h6>
                            <p class="text-muted mb-0">ë¹ˆë„, íŠ¸ë Œë“œ, íŒ¨í„´, í†µê³„, ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ë¡œ ë‹¤ê°ë„ ë¶„ì„</p>
                        </div>
                    </div>
                    <div class="about-feature-item">
                        <i class="fas fa-check-circle text-success me-3"></i>
                        <div>
                            <h6>ê°œì¸í™” ì¶”ì²œ ì‹œìŠ¤í…œ</h6>
                            <p class="text-muted mb-0">ì‚¬ìš©ìì˜ ì„ í˜¸ë²ˆí˜¸ë¥¼ ë°˜ì˜í•œ ë§ì¶¤ ì¶”ì²œ</p>
                        </div>
                    </div>
                    <div class="about-feature-item">
                        <i class="fas fa-check-circle text-success me-3"></i>
                        <div>
                            <h6>100% ë¬´ë£Œ ì„œë¹„ìŠ¤</h6>
                            <p class="text-muted mb-0">ê³ í’ˆì§ˆ AI ì˜ˆì¸¡ì„ ì™„ì „ ë¬´ë£Œë¡œ ì œê³µí•©ë‹ˆë‹¤</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="about-image text-center">
                    <div class="ai-brain-animation">
                        <i class="fas fa-brain fa-8x text-primary opacity-75"></i>
                        <div class="brain-pulse"></div>
                    </div>
                    <p class="mt-3 text-muted">AIê°€ 24ì‹œê°„ ì‹¤ì œ ë°ì´í„°ë¥¼ ë¶„ì„í•©ë‹ˆë‹¤</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Error Modal -->
<div class="modal fade" id="errorModal" tabindex="-1" aria-labelledby="errorModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-danger text-white">
                <h5 class="modal-title" id="errorModalLabel">
                    <i class="fas fa-exclamation-triangle me-2"></i>ì˜¤ë¥˜ ë°œìƒ
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p id="errorModalMessage">ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>
                <div class="mt-3">
                    <h6>í•´ê²° ë°©ë²•:</h6>
                    <ul class="small">
                        <li>í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ë³´ì„¸ìš”</li>
                        <li>ì¸í„°ë„· ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”</li>
                        <li>ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”</li>
                    </ul>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ë‹«ê¸°</button>
                <button type="button" class="btn btn-primary" onclick="location.reload()">í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™” í•¨ìˆ˜ë“¤
document.addEventListener('DOMContentLoaded', function() {
    initializePage();
});

async function initializePage() {
    try {
        // í†µê³„ ë°ì´í„° ë¡œë“œ
        await loadStatistics();
        
        // ì„œë²„ ìƒíƒœ í™•ì¸
        await checkServerStatus();
        
        // ì˜ˆì‹œë²ˆí˜¸ ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼ ì´ë²¤íŠ¸
        const refreshBtn = document.getElementById('refreshExampleBtn');
        if (refreshBtn) {
            refreshBtn.addEventListener('click', function() {
                if (window.lottoPro && window.lottoPro.updateHeroExampleNumbers) {
                    window.lottoPro.updateHeroExampleNumbers();
                }
            });
        }
        
        console.log('í˜ì´ì§€ ì´ˆê¸°í™” ì™„ë£Œ');
    } catch (error) {
        console.error('í˜ì´ì§€ ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
        showErrorMessage('í˜ì´ì§€ ì´ˆê¸°í™”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
    }
}

async function checkServerStatus() {
    try {
        const response = await fetch('/api/health');
        const health = await response.json();
        
        // ë°ì´í„° ì¹´ìš´íŠ¸ ì—…ë°ì´íŠ¸
        const dataCountDisplay = document.getElementById('dataCountDisplay');
        if (dataCountDisplay && health.sample_data_count) {
            dataCountDisplay.textContent = health.sample_data_count;
        }
        
        // ë¶„ì„ ìƒíƒœ ì—…ë°ì´íŠ¸
        if (health.analysis_status) {
            updateAnalysisStatus(health.analysis_status);
        }
        
        // ë°ì´í„° ì†ŒìŠ¤ ì •ë³´ ì—…ë°ì´íŠ¸
        const dataSourceText = document.getElementById('dataSourceText');
        if (dataSourceText) {
            dataSourceText.textContent = health.data_source || 'ë°ì´í„° ë¡œë”© ì¤‘...';
        }
        
        // ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸ ì‹œê°„
        const lastUpdate = document.getElementById('lastUpdate');
        if (lastUpdate) {
            const now = new Date();
            lastUpdate.textContent = now.toLocaleTimeString('ko-KR', { 
                hour: '2-digit', 
                minute: '2-digit' 
            });
        }
        
        // ë°ì´í„° í’ˆì§ˆ í‘œì‹œ
        const dataQuality = document.getElementById('dataQuality');
        if (dataQuality) {
            dataQuality.textContent = health.csv_loaded ? 'ì‹¤ì œ ë°ì´í„°' : 'ìƒ˜í”Œ ë°ì´í„°';
            dataQuality.className = health.csv_loaded ? 'text-success' : 'text-warning';
        }
        
    } catch (error) {
        console.error('ì„œë²„ ìƒíƒœ í™•ì¸ ì‹¤íŒ¨:', error);
        updateAnalysisStatus({
            frequency_analysis: false,
            trend_analysis: false,
            pattern_analysis: false
        });
    }
}

function updateAnalysisStatus(analysisStatus) {
    // íˆì–´ë¡œ ì„¹ì…˜ ë¶„ì„ ìƒíƒœ
    const statusSpinner = document.getElementById('analysisSpinner');
    const statusText = document.getElementById('analysisStatusText');
    
    const allAnalysisComplete = analysisStatus.frequency_analysis && 
                               analysisStatus.trend_analysis && 
                               analysisStatus.pattern_analysis;
    
    if (allAnalysisComplete) {
        if (statusSpinner) statusSpinner.style.display = 'none';
        if (statusText) {
            statusText.innerHTML = '<i class="fas fa-check-circle me-1"></i>ì‹¤ì œ ë°ì´í„° ë¶„ì„ ì™„ë£Œ';
            statusText.className = 'text-success';
        }
    } else {
        if (statusText) {
            statusText.innerHTML = '<i class="fas fa-cog fa-spin me-1"></i>ë°ì´í„° ë¶„ì„ ì¤‘...';
            statusText.className = 'text-warning';
        }
    }
    
    // ê°œë³„ ë¶„ì„ ìƒíƒœ ì—…ë°ì´íŠ¸
    updateIndividualAnalysisStatus('frequency', analysisStatus.frequency_analysis);
    updateIndividualAnalysisStatus('trend', analysisStatus.trend_analysis);
    updateIndividualAnalysisStatus('pattern', analysisStatus.pattern_analysis);
    
    // ì˜ˆì¸¡ ê²½ê³  í‘œì‹œ
    const predictionWarning = document.getElementById('predictionWarning');
    if (predictionWarning) {
        predictionWarning.style.display = allAnalysisComplete ? 'none' : 'block';
    }
}

function updateIndividualAnalysisStatus(type, isComplete) {
    // íŠ¹ì„± ì„¹ì…˜ ì¸ë””ì¼€ì´í„°
    const indicator = document.getElementById(`${type}Indicator`);
    if (indicator) {
        const icon = indicator.querySelector('i');
        if (icon) {
            icon.className = isComplete ? 
                `fas fa-${getIconName(type)} text-success` : 
                `fas fa-${getIconName(type)} text-muted`;
        }
    }
    
    // íŠ¹ì„± ì¹´ë“œ ìƒíƒœ
    const status = document.getElementById(`${type}Status`);
    if (status) {
        status.innerHTML = isComplete ? 
            '<small class="text-success">âœ… ë¶„ì„ ì™„ë£Œ</small>' : 
            '<small class="text-warning">â³ ë¶„ì„ ì¤‘...</small>';
    }
}

function getIconName(type) {
    const iconMap = {
        'frequency': 'chart-bar',
        'trend': 'trending-up',
        'pattern': 'project-diagram'
    };
    return iconMap[type] || 'cog';
}

async function loadStatistics() {
    try {
        const response = await fetch('/api/stats');
        const data = await response.json();
        
        if (data.hot_numbers && data.cold_numbers) {
            displayHotNumbers(data.hot_numbers);
            displayColdNumbers(data.cold_numbers);
            
            // í†µê³„ ìš”ì•½ ì •ë³´ ì—…ë°ì´íŠ¸
            const totalDraws = document.getElementById('totalDraws');
            if (totalDraws) {
                totalDraws.textContent = data.total_draws || '-';
            }
            
            // í†µê³„ ë°ì´í„° ì†ŒìŠ¤ í‘œì‹œ
            const statsSource = document.getElementById('statsSource');
            if (statsSource) {
                statsSource.innerHTML = `
                    <small class="text-success">
                        <i class="fas fa-database me-1"></i>${data.data_source}
                    </small>
                `;
            }
        }
    } catch (error) {
        console.error('í†µê³„ ë¡œë“œ ì‹¤íŒ¨:', error);
        showErrorMessage('í†µê³„ ë°ì´í„° ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
    }
}

function displayHotNumbers(hotNumbers) {
    const container = document.getElementById('hotNumbers');
    if (container && hotNumbers.length > 0) {
        container.innerHTML = hotNumbers.slice(0, 8).map(([num, freq]) => 
            `<div class="lotto-ball hot-number" title="${freq}íšŒ ì¶œí˜„" data-frequency="${freq}">${num}</div>`
        ).join('');
    }
}

function displayColdNumbers(coldNumbers) {
    const container = document.getElementById('coldNumbers');
    if (container && coldNumbers.length > 0) {
        container.innerHTML = coldNumbers.slice(0, 8).map(([num, freq]) => 
            `<div class="lotto-ball cold-number" title="${freq}íšŒ ì¶œí˜„" data-frequency="${freq}">${num}</div>`
        ).join('');
    }
}

function showErrorMessage(message) {
    const errorModalMessage = document.getElementById('errorModalMessage');
    if (errorModalMessage) {
        errorModalMessage.textContent = message;
        
        // Bootstrap ëª¨ë‹¬ í‘œì‹œ
        const errorModal = new bootstrap.Modal(document.getElementById('errorModal'));
        errorModal.show();
    }
}

// í˜ì´ì§€ ê°€ì‹œì„± ë³€ê²½ ì‹œ ìë™ ìƒˆë¡œê³ ì¹¨
document.addEventListener('visibilitychange', function() {
    if (!document.hidden) {
        // í˜ì´ì§€ê°€ ë‹¤ì‹œ ë³´ì¼ ë•Œ ìƒíƒœ í™•ì¸
        setTimeout(checkServerStatus, 1000);
    }
});
</script>
{% endblock %}
